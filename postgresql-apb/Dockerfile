FROM ansibleplaybookbundle/apb-base:canary
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHBvc3RncmVzcWwtYXBiCmRlc2NyaXB0aW9uOiBTQ0wgUG9zdGdy\
ZVNRTCBhcGIgaW1wbGVtZW50YXRpb24KYmluZGFibGU6IHRydWUKYXN5bmM6IG9wdGlvbmFsCm1l\
dGFkYXRhOgogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vd3d3LnBvc3RncmVzcWwub3JnL2Rv\
Y3MvCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBkZXBsb3lzIHBvc3RncmVzcWwgOS40\
LCA5LjUsIG9yIDkuNi4KICBkaXNwbGF5TmFtZTogUG9zdGdyZVNRTCAoQVBCKQogIGNvbnNvbGUu\
b3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNvbi1wb3N0Z3Jlc3FsCnBsYW5zOgogIC0gbmFtZTog\
ZGVmYXVsdAogICAgZGVzY3JpcHRpb246IEEgc2luZ2xlIERCIHNlcnZlciB3aXRoIG5vIHN0b3Jh\
Z2UKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogRGV2ZWxv\
cG1lbnQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gcHJvdmlkZXMgYSBzaW5nbGUg\
bm9uLUhBIFBvc3RncmVTUUwgc2VydmVyIHdpdGhvdXQgcGVyc2lzdGVudCBzdG9yYWdlCiAgICAg\
IGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfZGF0\
YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUKICAgICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAg\
ICAgdGl0bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIG1h\
eGxlbmd0aDogNjMKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHBvc3RncmVz\
cWxfcGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZXNjcmlwdGlvbjogQSBy\
YW5kb20gYWxwaGFudW1lcmljIHN0cmluZyBpZiBsZWZ0IGJsYW5rCiAgICAgICAgdGl0bGU6IFBv\
c3RncmVTUUwgUGFzc3dvcmQKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBk\
ZWZhdWx0OiAnOS42JwogICAgICAgIGVudW06IFsnOS42JywgJzkuNScsICc5LjQnXQogICAgICAg\
IHR5cGU6IGVudW0KICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAgICAgICAgcmVx\
dWlyZWQ6IHRydWUKCg=="


COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
